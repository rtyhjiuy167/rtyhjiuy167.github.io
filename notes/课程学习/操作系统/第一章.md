设计现代OS的主要目标：1）有效性。2）方便性。3）可扩充性。4）开放性。

推动多道批处理系统形成和发展的主要动力：1 ）不断提高计算机资源的利用率；2 ）方便用户；3 ）器件的不断更新换代；4 ）计算机体系结构的不断发展；5）不断提出新的应用需求

脱机 I/O 是指事先将装有用户程序和数据的纸带或卡片装入纸带输入机或卡片机，在外围机的控制下，把纸带或卡片上的数据或程序输入到磁带上。该方式下的输入输出由外围机控制完成，是在脱离主机的情况下进行的。
联机 I/O 方式是指程序和数据的输入输出都是在主机的直接控制下进行的。

操作系统特征：并发性、共享性、虚拟性和异步性

最基本的特征是并发性和共享性

操作系统的异步性体现在三个方面：
一是进程的异步性，进程以人们不可预知的速度向前推进；
二是程序的不可再现性，即程序执行的结果有时是不确定的；
三是程序执行时间的不可预知性，即每个程序何时执行，执行顺序以及完成时间是不确定的。

### 操作系统的作用

OS 的作用可表现三个方面：1）OS作为计算机系统资源的管理者，包括处理机管理、存储器管理、设备管理、文件管理；2）OS 作为用户与计算机硬件系统之间的接口；3）OS 实现了对计算机资源的抽象

#### OS作为计算机系统资源的管理者

（一）处理机管理

处理机管理的主要功能是：进程管理、进程同步、进程通信和处理机调度；

进程管理：为作业创建进程，撤销已结束进程，控制进程在运行过程中的状态转换。
进程同步：为多个进程（含线程）的运行进行协调。
进程通信：用来实现在相互合作的进程之间的信息交换。

处理机调度：（1）作业调度（2）进程调度

（二）存储器管理

内存管理的主要功能有：内存分配、内存保护、地址映射和内存扩充。

内存分配：为每道程序分配内存。
内存保护：确保每道用户程序都只在自己的内存空间运行，彼此互不干扰。
地址映射：将地址空间的逻辑地址转换为内存空间与之对应的物理地址。
内存扩充：用于实现请求调用功能，置换功能等。
内存共享：允许多个进程访问内存的同一部分。

（三）设备管理

主要功能有: 缓冲管理、设备分配和设备处理以及虚拟设备等。
主要任务 :  完成用户提出的 I/O 请求，为用户分配 I/O 设备；提高 CPU 和 I/O 设备的利用率；提高 I/O 速度；以及方便用户使用 I/O 设备

（四）文件管理

文件管理主要功能：文件存储空间的管理、目录管理、文件的读/写管理和保护。
文件管理的主要任务：管理用户文件和系统文件，方便用户使用，保证文件安全性。

#### OS 作为用户与计算机硬件系统之间的接口

（一）命令接口

使用命令接口进行作业控制的主要方式有两种，即联机控制方式和脱机控制方式。按作业控制方式的不同，可将命令接口分为联机命令接口和脱机命令接口。

联机命令接口又称交互式命令接口，适用于分时或实时系统的接口。

脱机命令接口又称批处理命令接口，适用于批处理系统。

（二）程序接口

程序接口由一组系统调用（也称广义指令）组成。

图形用户界面（GUI），即图形接口，最终是通过调用程序接口实现的。

#### OS 实现了对计算机资源的抽象

OS 首先在裸机上覆盖一层 I/O 设备管理软件，实现了对计算机硬件操作的第一层次抽象；在第一层软件上再覆盖文件管理软件，实现了对硬件资源操作的第二层次抽象。OS是铺设在计算机硬件操作的多层软件的集合，增强了系统的功能，隐藏了对硬件的具体细节，实现了对计算机硬件操作的多个层次的抽象模型。

没有任何软件支持的计算机称为裸机。把覆盖了软件的机器称为扩充机器或虚拟机。

### 处理器运行模式

（一）用户态（也称目态）

​	用户自编程序运行在用户态。

​	可运行的指令：”访管“指令

​	不可执行的指令：置时钟指令、广义指令、切换到用户态的指令、I/O指令

​	可在用户态发生的事件：系统调用、外部中断（包括缺页）

（二）核心态（也称管态、内核态）

​	操作系统内核程序运行在核心态。

​	可运行的指令：除”访管“指令的全部指令。

​	进程的切换只发生在核心态

注意：用户态与核心态的切换由硬件实现

### 中断和异常

中断处理是操作系统必须提供的功能，需要硬件支持。子程序调用只需保存程序断点，即该指令的下一条指令的地址；中断处理不仅要保存断点，还要保存程序状态字寄存器的内容。中断和异常的处理在核心态中完成。

（一）中断

中断也称外中断，是指来自 CPU 执行指令外部的事件。

外中断可分为可屏蔽中断和不可屏蔽中断。可屏蔽中断是指通过 INTR 线发出的中断请求，通过改变屏蔽字可以实现多重中断。不可屏蔽中断时指通过 NMI 线 发出的中断请求。

处理外中断时，PC值由中断隐指令自动保存，即硬件自动保存被中断程序的断点，而通用寄存器内容由操作系统保存。

中断向量表由操作系统初始化。

（二）异常

异常也称内中断，是指来自CPU执行指令内部的事件。异常不可屏蔽。

异常可分为故障、自陷和终止。故障通常是由指令执行引起的异常，如非法操作码、缺页故障、除数为0、运算溢出等。自陷（Trap）是一种事先安排的”异常“事件，用于在用户态下调用操作系统内核程序，如条件陷阱指令。故障和自陷输入软件中断。终止（Abort），属于硬件中断，是指出现了使得 CPU 无法继续执行的硬件故障，如控制器出错、存储器校验错。

### 宏内核与微内核

（一）宏内核

宏内核也称单内核或大内核，是指将系统的主要功能模块都作为一个紧密联系的整体运行在核心态，从而为用户程序提供高性能的系统服务。

缺点：占用内存空间大。缺乏可扩展性而不方便移植。可靠性较低。

（二）微内核

足够小的内核，基于客户/服务器模式，应用"机制与策略分离"原理，采用面向对象技术。

把操作系统中更多的成分和功能放到更高的层次(即用户模式)中去运行, 而留下一个尽量小的内核,用它来完成操作系统最基本的核心功能,称这种技术为微内核技术。

在微内核中通常提供了进程(线程)管理、低级存储器管理、中断和陷入处理等功能。

缺点：内核切换太慢，操作系统执行开销较大，系统效率较低。优点：结构稳定

### 操作系统引导

